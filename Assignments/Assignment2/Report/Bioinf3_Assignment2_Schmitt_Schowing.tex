\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}

% \usepackage{ngerman}  % german documents
\usepackage{graphicx}  % import graphics einbinden
\usepackage{listings}  % support source code listing
\usepackage{amsmath}  % math stuff
\usepackage{amssymb} % 
\usepackage{a4wide} % wide pages
\usepackage{fancyhdr} % nice headers
\usepackage{float}
\lstset{basicstyle=\footnotesize,language=Python,breaklines=true,numbers=left, numberstyle=\tiny, stepnumber=5,firstnumber=0, numbersep=5pt} % set up listings
\pagestyle{fancy}             % header
\setlength{\parindent}{0pt}   % no indentation

\usepackage[pdfpagemode=None, colorlinks=true,  % url coloring
           linkcolor=blue, urlcolor=blue, citecolor=blue, plainpages=false, 
           pdfpagelabels,unicode]{hyperref}
           
% change enums style: first level (a), (b), (c)           
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelenumii}{(\arabic{enumii})}

%lecture name
\newcommand{\lecture}{
	Bioinformatics III
}           

%assignment iteration
\newcommand{\assignment}{
	Second Assignment
}


%set up names, matricle number, and email
\newcommand{\authors}{
  \begin{tabular}{rl}
    \href{mailto:s8tbscho@stud.uni-saarland.de}{Thibault Schowing} & (2571837)\\
    \href{mailto:wiebkeschmitt@outlook.de}{Wiebke Schmitt} & (2543675)
  \end{tabular}
}

% use to start a new exercise
\newcommand{\exercise}[1]
{
  \stepcounter{subsection}
  \subsection*{Exercise \thesubsection: #1}

}

\begin{document}
\title{\Large \lecture \\ \textbf{\normalsize \assignment}}
\author{\authors}

\setlength \headheight{25pt}
\fancyhead[R]{\begin{tabular}{r}\lecture \\ \assignment \end{tabular}}
\fancyhead[L]{\authors}


\setcounter{section}{2} % modify for later sheets, i.e. 2, 3, ...
%\section{Introduction to Python and some Network Properties} % optional, note that section invocation sets the section counter + 1, so adapt the setcounter command
\maketitle

\exercise{The Scale-Free network}
\begin{enumerate}
\item \textit{Implement the algorithm given in the lecture to set up a scale-free network according to the
	Barab√°si-Albert model (see Lecture 2, slide 8). Start from the first three connected nodes
	and add each new node with a given number of links. Connect the new links with increasing
	preference to nodes that have higher degrees. This ScaleFreeNetwork-class should again
	use the abstract network class that you wrote in the first assignment.
	To obtain a much faster implementation and full points, think of a method to map the
	probabilities to connect to nodes somehow instead of computing them from scratch in each
	iteration.}\\
Implementation of the missing methods for the ScaleFreeNetwork-class. Listing \ref{ex2-a} shows source code of ScaleFreeNetwork.py.

\lstinputlisting[label=ex2-a,caption={ScaleFreeNetwork.py}] {../Scripts/ScaleFreeNetwork.py}

\item \textit{Determine the degree distributions for scale-free networks of 10 000 and 100 000 nodes
	(each with two new links per iteration), respectively, and plot them with double logarithmic
	axes. A new pre-implemented method in Tools.py will help you with that. What are the
	differences?
	Next, compare one of the distributions to the degree distribution of an equally sized random
	network (play around with the plot-scaling). What are the major differences?
}\\



%TODO insert image with the two scale free and the random distrib

\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{../Scripts/Figure_1}
	\caption[Scale-Free vs Random]{We can observe that the Scale-Free distribution follow a power-law style, as it is almost a straight line when ploted with log-log axes. On the other hand, the random network is more Poisson distributed as seen in Assignment 1.}
	\label{fig:figure1}
\end{figure}


\lstinputlisting[label=ex2-b, caption={ScaleFreeTest.py}] {../Scripts/ScaleFreeTest.py}

\item \textit{The degree distribution of a scale-free network follows a power law, which has the form $P(k) ~ k^{-\lambda}$ To simplify the exercise, we assume $P(k) ~ Ck^{-\lambda}$ with $C$ being a fixed normalization
	constant to obtain a proper distribution. Try to fit this theoretical distribution to the
	degree distribution of a random network using the Kolmogorov-Smirnov distance. }


\lstinputlisting[label=ex2-c, caption={Tools.py}] {../Scripts/Tools.py}

\textit{Use the KS distance to determine a $\gamma$ (between 1 and 3, 0.1 steps sufficient) that fits
	best to the degree distribution of a scale-free network with 10 000 nodes and two new
	links per iteration. Compare the empirical distribution of the network to the theoretical
	distribution with optimal $\gamma$ in a double-log. plot. Comment on the quality of your fit,
	reason why it may fail and how it could be vastly improved.}


%TODO discussion.... follows the theory until some point 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.7\linewidth]{"../Scripts/Compare theory to practice"}
	\caption[Theory vs Practice]{}
	\caption{}
	\label{fig:compare-theory-to-practice}
\end{figure}

\end{enumerate}



\exercise{Classify real-world network examples}
\begin{enumerate}
	\item bla 
	
	
	\item bla
	
	
	\item bla
	

\end{enumerate}
	
	
	
	
	
	
	
\exercise{Real interaction networks}
\begin{enumerate}
	\item Here is the implementation of the BioGRIDReader-class
	\lstinputlisting[label=ex23-c, caption={BioGRIDReader.py}] {../Scripts/BioGRIDReader.py}
	
	
	
	\item The class getMostAbundantTaxonIDs(n) is listed in the listing \ref{ex23-c} above. 
	
	
	\item \textit{How big is the human interaction network and which are the 10 proteins with the highest
		degree? Take one of them as an example and briefly explain the biology behind the
		connectivity.}\\
	
	%TODO answer question properly
	The most abundent TaxonIDs are (id, qty):  [('559292', 704012), ('9606', 414501), ('316407', 184023), ('284812', 72149), ('7227', 67935)]
	
	\begin{itemize}
		\item 559292: Saccharomyces cerevisiae (Baker's Yeast)
		\item   9606: Human (Homo sapiens) 
		\item 316407: Escherichia coli
		\item 284812: Schizosaccharomyces pombe (Fission yeast)
		\item   7227: Drosophila melanogaster
	\end{itemize}
	
	Number of Human-Human interactions (human id = 9606):  386192
	
	The  10  proteins with the highest degree are: 
	[('ETG7157', 3024), ('ETG7706', 2559), ('ETG351', 2454), ('ETG1956', 2134), ('ETG7316', 2042), ('ETG4914', 2002), ('ETG4193', 1939), ('ETG672', 1876), ('ETG1994', 1840), ('RP4-811H24.2', 1646)]
	
	
	This network has  17087 nodes.
	
	\item Generic network implementation 
	\lstinputlisting[label=ex23-d, caption={GenericNetwork.py}] {../Scripts/GenericNetwork.py}
	
	
	
\end{enumerate}	
	




\end{document}